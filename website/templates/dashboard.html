<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Weather App</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body class="g-sidenav-show bg-gray-100">
    <div class="min-height-300 bg-dark position-absolute w-100"></div>
    <main class="main-content position-relative border-radius-lg">
        <!-- Navbar -->
        <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur" data-scroll="false">
            <div class="container-fluid py-1 px-3">
                <nav aria-label="breadcrumb">
                    <h6 class="font-weight-bolder text-white mb-0">Weather App</h6>
                </nav>
            </div>
        </nav>
        <!-- End Navbar -->

        <div class="container-fluid py-4">
            <div class="row">
                <div class="col-12">
                    <div class="card mb-4">
                        <div class="card-body p-3">
                            <h2>Weather Information</h2>
                            <!-- Weather Form -->
                            <form method="POST" class="mt-4">
                                <div class="mb-3">
                                    <label for="city" class="form-label">City</label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                </div>
                                <div class="mb-3">
                                    <label for="state" class="form-label">State (optional)</label>
                                    <input type="text" class="form-control" id="state" name="state">
                                </div>
                                <div class="mb-3">
                                    <label for="country" class="form-label">Country</label>
                                    <input type="text" class="form-control" id="country" name="country" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Get Weather</button>
                            </form>

                            <!-- Error Message -->
                            {% if error_message %}
                                <div class="alert alert-danger mt-4">
                                    {{ error_message }}
                                </div>
                            {% endif %}

                            <!-- Weather Data -->
                            {% if weather_data %}
                                <div class="mt-4">
                                    <!-- Current Weather Card -->
                                    <div class="card">
                                        <div class="card-body">
                                            <h3 class="card-title">Current Weather</h3>
                                            <p class="card-text">{{ weather_data.name }}, {{ weather_data.sys.country }}</p>
                                            <p class="card-text">{{ weather_data.weather[0].description }}</p>
                                            <img src="http://openweathermap.org/img/wn/{{ weather_data.weather[0].icon }}.png" alt="Weather Icon" width="100" height="100">
                                            <p class="card-text"><strong>Temperature:</strong> {{ weather_data.main.temp }}°C</p>
                                            <p class="card-text"><strong>Feels like:</strong> {{ weather_data.main.feels_like }}°C</p>
                                            <p class="card-text"><strong>Wind Speed:</strong> {{ weather_data.wind.speed }} km/h</p>
                                            <p class="card-text"><strong>Humidity:</strong> {{ weather_data.main.humidity }}%</p>
                                            <p class="card-text"><strong>Visibility:</strong> {{ weather_data.visibility / 1000 }} km</p>
                                            <p class="card-text"><strong>Pressure:</strong> {{ weather_data.main.pressure }} mb</p>
                                            <p class="card-text"><strong>Dew Point:</strong> {{ weather_data.main.temp_min }}°C</p>
                                        </div>
                                    </div>

                                    <!-- Forecast Section -->
                                    <div class="card mt-4">
                                        <div class="card-body">
                                            <h3 class="card-title">5-Day Forecast</h3>
                                            <div class="row">
                                                {% if forecast_data %}
                                                    {% for forecast in forecast_data.list %}
                                                        {% if forecast.dt_txt.endswith('12:00:00') %}
                                                            <!-- Show only one forecast per day -->
                                                            <div class="col">
                                                                <p class="card-text"><strong>{{ forecast.dt_txt.split(' ')[0] }}</strong></p>
                                                                <p class="card-text">{{ forecast.main.temp_min }}° / {{ forecast.main.temp_max }}°</p>
                                                                <p class="card-text">{{ forecast.weather[0].description }}</p>
                                                                <img src="http://openweathermap.org/img/wn/{{ forecast.weather[0].icon }}.png" alt="Weather Icon" width="50" height="50">
                                                            </div>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% else %}
                                                    <p class="card-text">No forecast data available.</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>